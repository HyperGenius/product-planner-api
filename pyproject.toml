[tool.ruff]
# 対象のPythonバージョン
target-version = "py311"
line-length = 88

[tool.ruff.lint]
# 有効にするルールセット
# E, W: Pycodestyle (標準的なスタイル)
# F: Pyflakes (エラー検出)
# I: Isort (import順序の自動整理)
# B: Flake8-bugbear (バグの温床になりやすいコードの検出)
# UP: Pyupgrade (古い構文のアップデート)
# N: PEP8-naming (命名規則)
# C901: 循環的複雑度（Cyclomatic Complexity）
select = ["E", "W", "F", "I", "B", "UP", "N", "C901"]

# 無視するルール
# E501: 行長制限 (Ruffのformatterに任せるためlintでは無視)
ignore = ["E501"]

[lint.mccabe]
# 10〜15程度に設定して長すぎる関数を持つファイルを検出
max-complexity = 10

[tool.ruff.format]
quote-style = "double"
indent-style = "space"

[tool.ruff.lint.flake8-bugbear]
# B008のチェック対象から外す関数を指定
extend-immutable-calls = [
    "fastapi.Depends",
    "fastapi.Security",
    "fastapi.Query",
    "fastapi.Path",
    "fastapi.Body",
    "fastapi.Header",
]

[tool.mypy]
# 型チェックの設定
python_version = "3.11"
warn_unused_configs = true
warn_return_any = false
disallow_untyped_defs = false     # すべての関数に型ヒントを必須にする
disallow_incomplete_defs = false  # 不完全な型ヒントを禁止する
check_untyped_defs = true         # 型ヒントのない関数もチェックする
ignore_missing_imports = true     # 外部ライブラリの型定義がない場合の警告を抑制

exclude = [
    "scripts/.*",
]

[[tool.mypy.overrides]]
module = ["supabase", "supabase.*", "gotrue.*", "postgrest.*"]
ignore_errors = true
ignore_missing_imports = true

[tool.pytest.ini_options]
pythonpath = ["."]
addopts = "-ra -q"
testpaths = [
    "__tests__",
]
